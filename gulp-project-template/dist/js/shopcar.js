"use strict";require(["config"],function(){require(["header","jquery","url"],function(t,s,l){t.init();var n,e;n=new RegExp("(^|&)"+"id"+"=([^&]*)(&|$)"),null!=(e=window.location.search.substr(1).match(n))&&unescape(e[2]);document.getElementById("table").onclick=function(t){var n=t.target||t.srcElement;if("delBtn"==n.className){var e=n.parentNode.parentNode.children[1].innerText;console.log(e),s.ajax({type:"GET",url:l.url+"/api/v1/del.php",data:{name:e},success:function(){window.location.reload()},error:function(){alert("删除失败")}})}},s.ajax({type:"GET",url:l.url+"/api/v1/shopadd.php",dataType:"json",success:function(t){if(console.log(t),0==t.length){document.getElementById("insert").innerHTML='<div id="makesure">\n\t\t\t\t\t\t\t<img src="/images/makesure.png">\n\t\t\t\t\t\t\t<a href="/html/list.html"></a>\n\t\t\t\t\t\t\t</div>',s("#content").css("display","none"),s("#makesure").css("display","block")}for(var n="",e=0;e<t.length;e++)n+='<tr class="delthis">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<img src="'.concat(t[e].img,'" width="100">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class="thisname">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="ins">').concat(t[e].name,'</a>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class="danjia">\n\t\t\t\t\t\t\t\t\t\t').concat(t[e].price,'\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span class="reduce" name="toreduce">-</span>\n\t\t\t\t\t\t\t\t\t\t<input type="text" name="" value="').concat(t[e].val,'" class="count" disabled>\n\t\t\t\t\t\t\t\t\t\t<span class="add" name="toAdd">+</span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class="price">\n\t\t\t\t\t\t\t\t\t\t').concat(t[e].allprice,'\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" title="删除" class="delBtn">X</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>');document.getElementById("tbody").innerHTML=n,console.log(s("span[name='toAdd']")),s("span[name='toAdd']").each(function(t){s(this).off("click").on("click",function(){var t=Number(s(this).parents(".delthis").children(".danjia").html()),n=s(this).parent().siblings(".thisname").children(".ins").html(),e=Number(s(this).siblings(".count").val());e++;s(this).parents(".delthis").children(".price").html(t*e);var a=s(this).parents(".delthis").children(".price").html(),i=Number(s(this).siblings(".count").val())+1;s(this).siblings(".count").val(e),s.ajax({type:"GET",url:l.url+"/api/v1/updata.php",data:{allprice:a,val:i,name:n}})})}),s("span[name='toreduce']").each(function(t){s(this).off("click").on("click",function(){var t=Number(s(this).parents(".delthis").children(".danjia").html()),n=s(this).parent().siblings(".thisname").children(".ins").html(),e=Number(s(this).siblings(".count").val());--e<1&&(e=1),s(this).parents(".delthis").children(".price").html(t*e);var a=s(this).parents(".delthis").children(".price").html(),i=Number(s(this).siblings(".count").val())-1;console.log(i),console.log(a),s(this).siblings(".count").val(e),s.ajax({type:"GET",url:l.url+"/api/v1/updata.php",data:{allprice:a,val:i,name:n}})})})},error:function(){}})})});